## 组态

* 组态对移动机器人来说是一个变数状态叙述，说明移动机器人目前位置。
* 例如在平面上移动机器人，其中一种变数表示法$(x,y,\theta)$.
* 所有组态集合的空间为组态空间Q。$Q=R^2 \times SO(2)$。
* 被障碍物占据的机器人组态空间称为障碍物组态空间QO.
* 不会与障碍物碰撞的工作空间称为无碰撞组态空间。$QO_{free}$。$QO_{free}=Q-QO$

# 人工位能场路径规划

* 基本想法是将机器人当成组态空间中的一个粒子，并受到环境人工位能场U的影响。
* 机器人在这位能场下呗终点位置所吸引，同时也被周遭的障碍物所排斥。
* 人工位能场表示成$U(q)=U_{att}(q)+U_{rep}(q)$。

* 解决人工位能场路径规划的最简单的方法就是梯度法。
* 对机械手臂来说，梯度法作用在关节上的力矩表示成：

$$
\tau(q)=-\nabla U(q)=-\nabla U_{att}(q)-\nabla U_{rep}(q)
$$

# 人工位能场之吸引力

* 定义$U_{att,i}$给每个DH坐标系原点$O_i$,当每个$Q_i$到达目的点及完成路径规划。$-U_{att,i}$需单调增加随着$O_i$到终点位置的增加。
* 锥形位能场。
* 抛物线位能场。
* 混合锥形与抛物线位能场。

### 锥形吸引力位能场

$$
U_{att,i}=||O_i(q)-O_i(q_f)||
$$

考虑梯度（微分），一阶的表达式存在不可微分点，造成吸引力不连续，所以有了抛物线位能场。

### 抛物线吸引力位能场

$$
U_{att,i}=\frac{1}{2}\zeta_i||O_i(q)-O_i(q_f)||^2
$$

二阶表达式的吸引力位能场都能连续，$\zeta_i$调整吸引力位能场影响的参数。
$$
F_{att,i}(q)=-\nabla U_{att,i}(q)=-\zeta(O_i(q)-O_i(q_f))
$$
上式代表吸引到目的地的力，随着目前与目的地的距离远近做线性的改变。

### 混合锥形与抛物线位能场

* 若选用抛物线巍峨能唱，则当机器人在起始点时，吸引力位能场相当大（二次曲线。
* 又要保留位能场在接近目的地时可连续微分
* 所以：起始点用锥形位能场，当机器人靠近目的地到某一距离时，改用抛物线位能场。

$$
U_{att,i}(q)=
\begin{cases}
\frac{1}{2}\zeta_i||O_i(q)-O_i(q_f)||^2;||O_i(q)-O_i(q_f)||\leq d\\
d\zeta_i||O_i(q)-O_i(q_f)||-\frac{1}{2}\zeta_id^2;||O_i(q)-O_i(q_f)||> d
\end{cases}
$$

# 人工位能场排斥力

* 根据障碍物到每个DH坐标系原点的距离来给定排斥力，机器人在障碍物边界排斥力无限大，距离越远越小，直到某个特定距离排斥力为零。
* 用每个连杆DH坐标系原点不能保证机器人不碰撞，可设定机器人排斥力范围。

$$
U_{rep,i}(q)=\begin{cases}
\frac{1}{2}\eta_i(\frac{1}{\rho(O_i(q))}-\frac{1}{\rho_0})^2;\rho(O_i(q))\leq \rho_0\\
\qquad 0             \qquad \qquad ;  \rho(O_i(q))> \rho_0                                 
\end{cases}\\
F_{rep,i}(q)=\eta_i(\frac{1}{\rho(Q_i(q))}-\frac{1}{\rho_0})\cdot \frac{1}{\rho^2(Q_i(q))}\nabla\rho(Q_i(q))
$$

$\nabla\rho(Q_i(q))$在$x=O_i(q)$的梯度。

如果障碍物是凸面且b为障碍物上距离机器人$O_i$最近的点，所以$\rho(O_i(q))=||O_i(q)-b||$
$$
\nabla\rho(x)|_{x=O_i(q)}=\frac{O_i(q)-b}{||O_i(q)-b||}
$$
