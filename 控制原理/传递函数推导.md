# 辨识传递函数推导

![image-20211110215505384](..\picture\image-20211110215505384.png)

由上图可得：
$$
\begin{align}
y&=G[C[r-(y+n)]+w_u]+w  \\
&=GC\cdot r-GC\cdot y-GC\cdot n+Gw_u+w
\end{align}
$$
化简可得：
$$
y={GC\over {1+GC}}r+{G\over {1+GC}}w_u+{1\over{1+GC}}w-{GC\over{1+GC}}n
$$

$$
\begin{align}
y&=Gu+w	\\
u&=C[r-(y+n)]+w_u\\
u&=C[r-(Gu+w+n)]+w_u\\
&=Cr-GCu-Cw-Cn+w_u \\
u&={G\over {1+GC}}r+{1\over {1+GC}}w_u-{C\over{1+GC}}w-{C\over{1+GC}}n
\end{align}
$$

$$
\begin{align}
y&=G(u'+w_u)+w	\\
u'&=C[r-(y+n)]\\
u'&=C[r-(Gu'+Gw_u+w+n)]\\
&=Cr-GCu'-GCw_u-Cw-Cn \\
u'&={C\over {1+GC}}r-{GC\over {1+GC}}w_u-{C\over{1+GC}}w-{C\over{1+GC}}n
\end{align}
$$

其中：${GC\over {1+GC}}$称为闭环传递函数，${G\over {1+GC}}$称为过程灵敏度函数，${1\over {1+GC}}$称为灵敏度函数。

## 辨识

采用灵敏度函数辨识方法，分别得到${w_u,u}$和${w_u,y}$的灵敏度和过程灵敏度。
$$
S={u\over w_u}={1\over 1+GC}		 \\
S_p = {y\over w_u} = {G\over {1+GC}}\\
$$
则可得系统传递函数：
$$
G={y\over u}={S_p\over S}
$$
根据${w_u,u'}$得到系统的闭环传递函数：
$$
u'=-{GC\over 1+GC}w_u\\
CL = {GC\over 1+GC} = -{u'\over w_u}
$$
根据${w_u,u}$和${w_u,u}$得到系统的开环传递函数：
$$
\begin{align}
OL &= CL\cdot S^{-1}\\
&=-{-u'\over u}\\
&=CG
\end{align}
$$
可以得到控制器传递函数为：
$$
\begin{align}
C&=OL\cdot G^{-1}\\
&=-{u'\over u}\cdot {u\over y} \\
&=-{u'\over y}
\end{align}
$$
